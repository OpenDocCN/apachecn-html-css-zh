# 一、Web 应用的世界简介

通过 HTML5 和 WebSockets, Web 应用开发已经达到了一个新的水平。 web 开发技术的革命性改进已经为开发人员配备了现代工具和技术。 使用 WebSockets，他们可以创建不仅可以从客户端也可以从服务器端发送数据的 web 应用。 创建具有实时数据传输的 Web 应用时，可以大大减少对带宽的使用。 WebSockets 通过补充 HTML5 增强的特性可以使未来的应用变得强大。 在详细理解 WebSockets 之前，让我们先来讨论一下 Web 的基础知识。

# 什么是网络?

网络的建立是在 80 年代后期。 网络是在我们可以通过因特网访问的相互链接的超文本文件上工作的。 浏览器在阅读和将这些超文本文档转换为可读且更有意义的格式(即我们所说的网页)方面起着至关重要的作用。 HTML5 是一个超文本文档，由浏览器为我们读取和呈现。 浏览器不仅读取和呈现，而且为我们创建了**文档对象模型**(**DOM**)，以便我们能够轻松地读取和操作该结构。 DOM 的动态操作可以通过 JavaScript 语言实现，它是 HTML 的标准脚本语言。 服务器在 Web 的运行中起着至关重要的作用。 我们主要把 Web 分为两部分:客户机和服务器。 客户端被认为是浏览器，而服务器是向客户端提供数据的人。

让我们看看网络是如何工作的:

1.  浏览器从服务器请求一个 URL。
2.  服务器检查并返回 HTML 文件。
3.  浏览器引擎绘制页面。

简而言之，这就是 Web 的工作方式。 浏览器和服务器是 Web 最重要的实体。 浏览器具有读取 HTML 文件并以 HTML 文件描述的方式呈现 web 应用的引擎。 不同的浏览器，如 Blink、Trident、Gecko、WebKit 等，都有不同的引擎来呈现页面的 HTML。 现在服务器是存储所有数据并在用户请求时提供相同数据的人。

# Web 应用

在 Web 的初期，页面是静态的。 它们只用于显示具有最小交互性和功能的内容。 但是随着 Web 标准的提高以及计算机、高效浏览器、增强的工具和库的发展，创建 Web 应用现在变得非常容易，并且可以非常迅速地添加许多功能。

下面是 web 应用的一个简单定义——任何运行在浏览器上的应用都是 web 应用。 在我们的日常生活中，有许多 web 应用用于检查邮件、阅读新闻、观看视频等等。 Web 应用在浏览器中运行，不需要占用太多的计算机资源。

互联网正在以非常高的速度增长。 许多公司都在 Web 上构建他们的应用。 第一个也是最重要的好处是它独立于操作系统。 你可以在 Windows、Mac 或 Linux 上运行它，它的工作原理是一样的，因为这些工作主要是由浏览器完成的，而且它们适用于大多数操作系统。

以下是一些 web 应用的例子:

*   Gmail
*   Dropbox
*   Flickr
*   脸谱网

# WebSockets 适合哪里?

正如我们已经看到的一些 web 应用的例子，现在的问题是 WebSockets 在这些应用或任何 web 应用中适用于哪里? 让我们首先了解一些关于应用行为的内容; 让我们以**Gmail**为例，它基本上是一个邮件客户机。 邮件客户机的工作是获取邮件并显示它们。 这听起来很简单，但当有人给您发送邮件，而您希望该邮件立即显示时，问题就出现了。 要实现这样的功能，有不同的方法，比如轮询和长轮询，它们都不是有效的。 所以 WebSockets 通过提供服务器推功能来解决这个问题。 WebSockets 提供了从客户端和服务器端推送的功能，这使它脱颖而出。

与其他通信方法相比，WebSockets 具有一些很好的特性和巨大的优势。 WebSockets 的一些特性和好处是:

*   全双工通信
*   低带宽消耗
*   安全
*   低延时
*   通过**传输控制协议**(**TCP**)工作(尽管初始握手需要 HTTP)
*   支持几乎所有的网络浏览器和网络服务器，包括移动浏览器

我们可以把 WebSockets 看作是一种增强 web 应用体验的功能。 使用 html5 增强的特性，我们可以创建一个动态和实时的应用。

# WebSockets 优于其他方法

在客户机和服务器之间实现数据通信有多种不同的方式。 **Flash**，**Comet**，**PusherApp**等为我们提供了实现 WebSockets 提供的数据通信所需的特性。 那么问题来了，为什么我们要使用 WebSockets 呢? 选择 WebSockets 而不是其他方法有很多原因，其中一些原因如下:

*   与其他数据通信方式相比，WebSockets 显示出较低的延迟，从近 150ms 减少到 50ms。
*   WebSockets 是一种轻量级连接，使用的带宽很低。
*   就不同技术的学习和实现而言，它需要较少的开发人员努力。
*   使用不同技术时，易于编译。
*   使用 WebSockets，代码维护变得很容易。
*   WebSockets 提供了全双工连接支持，而开销不大。

# 现代浏览器

现代浏览器都配备了先进的功能来支持 web 应用。

Web 应用有很多不同的特性，为了支持这些特性，我们需要浏览器——不仅仅是普通的浏览器，而是现代的浏览器。 现代浏览器要支持 HTML5 提供的高级特性，就必须实现 HTML5 标准，因为它拥有最新的特性和功能。 有一些版本的浏览器不支持 HTML5，主要是因为它们没有实现 HTML5 标准，要么是因为它们开发得更早，要么是因为它们选择不实现 HTML5 标准。

现代浏览器的一些优势如下:

*   良好的性能
*   良好的安全
*   较小的问题
*   加快页面加载
*   实验**应用编程接口**或**API**
*   支持最新功能
*   访问本地资源

# HTML

HTML 是一种标记语言，浏览器使用它来呈现网页。 它是由**World Wide Web**(**W3**)确定的标准。 该标准定义了一些不同浏览器实现的元素。

# HTML5——现代网络标准

经过 8 年的工作，W3 于 2014 年 10 月 28 日最终确定了 HTML5 标准。 这一标准将对未来的网络产生革命性的影响。 对 HTML 标准的增强是革命性的。 让我们来看看 HTML5 的主要特性，这使得它成为一个伟大的 Web 标准:

## Media – audio/video

HTML5 标准中引入的一个重要特性是媒体回放。 我们现在可以直接使用浏览器播放音频/视频。 早些时候，我们使用一些插件来播放音频和视频，这为我们的 web 应用增加了另一层。 例如**YouTube**使用 Flash 播放器播放视频，但现在我们可以直接播放视频。 对于完全使用 HTML 构建的应用来说，这个特性是一个更大的优势。

除了播放音频和视频，我们还可以捕获设备的音频和视频资源。 可以使用`getUserMedia()`API 访问摄像头和麦克风，但它仍然不能用于所有浏览器，因为这是一个实验性功能; 然而，这是一个非常需要的特性。 这个 API 不仅可以访问桌面计算机，还可以访问移动和平板设备中的摄像头和麦克风。 这是另一个特性，它将消除对不同插件的媒体访问和捕获的依赖。

## 帆布

Canvas 让你在运行时对每个像素进行操作。 因此，您可以绘制形状、渲染图形、给它们上色、操作它们，甚至操作每个像素的位图图像，以及更多的特性。 canvas 特性让我们在绘图和制作 web 应用时占据上风，就像 Microsoft Paint(以前的 Microsoft Paintbrush)或 Adobe Photoshop 一样。

canvas 元素有一组不同的方法来使用线条、圆圈、框、文本、图形等创建绘图。 JavaScript 用于在画布容器中绘制。

## 表单元素

表单元素中有许多增强功能，这些增强功能帮助我们为用户创建很棒的体验，并且从开发人员的角度来看，这些功能很容易管理。 验证在早期是个大问题; 我们必须为它编写自己的代码，但现在它是元素的一部分。 有一些改进是要牢记移动设备的，比如字段类型键盘——例如，用于数字字段的专用键盘。 新元素包括:

*   **输入**:输入类型如下:
    *   `type="email"`:内置电子邮件验证器的字段
    *   `type="url"`:内置 URL 验证器的字段
    *   `type="number"`:一个内置数字输入限制和验证器的字段
    *   `type="range"`:具有最大值和最小值功能的范围滑块
*   **数据列表**:为列表控制指定预定义的选项列表。
*   **Keygen**:该元素使用公钥/私钥方法提供安全的数据提交。 从安全性的角度来看，这是一个很好的增强。
*   **Output**:这个元素在表单填充期间帮助显示输出值。

## 语义

语义是有意义的元素。 每个开发人员都希望使用易于理解和实现的语言编写代码。 语义是使代码更容易阅读和理解的东西，因为它定义了元素或标记的一部分的含义。 语义元素的例子有`<audio>`、`<video>`、`<form>`和`<table>`。 非语义元素的例子包括`<div>`和`<span>`。 从这些例子中我们可以看到，非语义元素并不告诉我们内容，而语义元素清楚地告诉我们内容。

HTML5 中的一些新语义如下:

*   `<section>`
*   `<nav>`
*   `<article>`
*   `<aside>`
*   `<hgroup>`
*   `<header>`
*   `<footer>`

这些新元素的添加将有助于使代码更具可读性和意义。 现在让我来介绍一下自定义元素。 是的，现在我们可以使用 JavaScript 创建自己的自定义元素，可以从头创建元素，也可以通过向 DOM 元素添加新行为来扩展默认的 DOM 元素集。 通过这种方式，我们可以创建不同的可重用 web 组件集，并在我们的 web 应用中使用它们。 这个特性为代码增加了意义，对于大型应用来说，这是一个很大的优势，可以使 web 组件可重用。

## 手机优先

HTML5 和 CSS3 标准是针对移动设备而制定的。 有许多改进可以优化移动/平板设备上的代码。 手机已经发展到一定程度，成为我们日常生活的一部分。 我们开始更多地在移动/平板设备上浏览互联网。 HTML5 为 Web 提供了强大的功能，以满足现代 Web 的需求。 HTML5 和 CSS3 具有一些出色的特性，可以为所有设备(桌面、移动和平板电脑)提供相同的内容。 一些重要的功能包括以下几点:

*   **视口**:这有助于根据设备调整网页的视图。 我们可以设置一个不同的尺度，等等。
*   **媒体查询**:CSS 按屏幕大小; 这难道不是一个很棒的功能吗? 现在，通过使用媒体查询，CSS 样式可以在运行时更改。 响应式网页设计是现代网页的一个非常重要的特征。 我们需要根据屏幕大小来显示内容，对于较小尺寸的设备，它应该适应并显示适当的内容，消除页面中不太重要的内容。
*   **触摸事件**:这些是移动/平板设备的生命事件。 **Swipe**是 HTML5 DOM 的重要事件之一。

## 离线存储

世界正在以不同的技术出现，我们广泛地使用在线和网络服务，以创造一个有效的工作空间和一个网络世界，以满足我们的专业和个人需求。 在某些情况下，你需要离线访问网站，也就是说，你的设备上没有活跃的互联网连接。 这可以通过使用离线存储功能来实现。 一旦你打开了一个网页，你可以把数据放在缓存中，这样下次你打开它或者因为某些原因失去了连接，你仍然可以打开并使用它。

当用户需要将数据存储在本地时，脱机系统是非常重要的。 主要是在系统处于离线模式时重新加载或恢复页面。

每当我们打开一个 URL，它就会访问服务器然后服务器返回被请求的文件。 然后，浏览器呈现服务器提供的文件。 现在，万一我们脱机了，浏览器会控制我们，而不是通过访问服务器来获取文件，它会从我们之前打开它时缓存的本地副本中加载文件。 还有一个 API 告诉我们我们是在线还是离线。 这对于移动/平板设备来说是非常有用的，因为这些设备的连接随时都可能丢失。

## 地理定位

有许多应用使用地理位置，例如 Twitter、Facebook、Foursquare、谷歌地图等等。 作为 HTML5 的一部分引入这一功能，让开发者更容易获得他们设备的位置。

移动和平板设备有**全球定位系统**(**GPS**)，通过该 API 可以访问设备的硬件。 让我们以一个应用为例，您希望在该应用中查找附近的酒店。 使用 GPS，您的位置可以被检测到，并提供附近酒店的相应列表。 这个特性减少了开发人员在实现与地理位置相关的特性方面的工作量。 是的，它是一个需要用户许可才能工作的功能。 给用户一个提示，允许 web 应用访问他们的位置信息。

## 拖放

拖放是一个一直存在的特性，但只能通过一些插件来实现。 好消息是，现在它是 HTML5 标准的一部分。 通过利用这个特性，可以定义很多新的控件，因为我们还可以使用自定义语义特性来定义我们自己的自定义控件。

Web 应用使用大量不同控件或小部件的来以更友好的方式显示数据。 对于大型应用，列表和网格是显示数据的最重要控件，拖放扮演着非常重要的角色。 显示项目日历或时间轴的控件需要拖放功能以使其更可用。 一些基本的交互作用是:

*   重新排列列表中的项
*   将项目从一个列表移动到另一个列表
*   重新安排布局
*   拖动项目周围的画布
*   将文件从计算机拖动到浏览器

有许多拖放特性的好例子。 不同的公司已经实现并制作了他们自己的组件库，它实现了拖放功能。 例如 Sencha, jQueryUI, KineticJS, Kendo UI 等等。

## 网络工作者

Web 工作者只是在后台运行的 JavaScript。 JavaScript 主要用于在运行时操作网页的 HTML，并且只使用一个主线程。 Web 工作人员使得在后台运行一段 JavaScript 代码而不影响当前进程成为可能。 通常，当我们在 JavaScript 中运行一个进程时，它以队列的方式运行，这意味着一次只执行一个进程。 它会阻塞整个 UI 一段时间，你也无法点击按钮。 这对应用的性能产生了巨大的影响。 这就是为什么大型 web 应用在选择 HTML 时犹豫不决的原因之一，但 web 工作者肯定会改变这一点。

## JavaScript

HTML 页面是静态的; 为了使具有动态性和交互性，使用了 JavaScript。 JavaScript 被称为 Web 语言。 它基于**ECMAScript**，并且每个浏览器都运行 JavaScript。 从单击按钮、导航到页面、调用服务等所有交互操作都是由 JavaScript 完成的。

有很多框架是使用 JavaScript 构建的，以使脚本更容易使用:其中一个主要使用的框架是 jQuery。 它为用户提供了以一种可读且有意义的方式使用 DOM 事件、特性和 API 的灵活性。

## 现代服务器

JavaScript 正在快速地改进。 大多数开发人员现在都在使用 JavaScript 进行客户端处理。 **Node.js**服务器的引入改变了开发人员的工作范围。 早些时候，开发人员使用不同的服务器，为此，他们不得不学习许多不同的语言。 Node.js 消除了这个差距，并为开发人员提供了一个平台，他们可以构建一个基于 JavaScript 的服务器。

在 Node.js 平台上构建的 JavaScript 服务器使用起来非常简单，同时也提高了生产力。 开发人员可以制作一个服务器并在很短的时间内运行它。 在 Node.js 中创建服务器非常简单，并且具有许多特性，例如使用不同的可用包进行实时数据传输。 有许多框架是为 Node.js 构建的，如**Express.js**，这有助于加快开发过程。

Node.js 是一个免费平台，它提供了很多不同的包，可以免费分发。 **节点****包管理器**(**NPM**)管理应用的依赖关系。 它也是一个版本管理器。

## WebSockets

随着 web 应用的增长，对支持全双工通信的实时数据的需求也增加了。 实时通信总是很难实现，人们使用 Flash 来实现这一点。 之所以使用类似 flash 的插件，是因为 HTML 标准中没有这个特性。 因此，无论何时我们想要在 HTML 中实现这样的机制，我们都使用轮询机制，这在性能方面是一个非常昂贵的过程。

HTML5 为一个好的 web 应用所需要的所有特性做好了准备。 WebSockets 是 HTML5 标准的一部分，WebSocket API 完全可用。

WebSockets 在客户端和服务器之间提供了全双工通信，这基本上允许根据需要轻松地传输数据，而不像轮询机制，我们在间隔时间内不断访问服务器以检查更改。 WebSockets 可以从服务器端或客户端发送数据——基本上是打开一个连接桥，允许数据从双方传输。 WebSockets 已经消除了第三方插件的使用，让 HTML 开发者能够直接使用 WebSockets API 来实现它。

# 总结

在这一章中，我们已经看到了现代 Web 的重要元素，以及 HTML5 标准给我们带来的增强功能。 我们已经介绍了 WebSockets，在下一章中，我们将看到客户端和服务器端 WebSockets 的实现。